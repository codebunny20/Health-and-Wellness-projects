<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Thematic Match: Language, Math, History</title>
	<style>
		:root { --card-size: 120px; --gap: 12px; --radius: 12px; --shadow: 0 6px 18px rgba(0,0,0,.12); }
		html, body { height: 100%; }
		body {
			margin: 0;
			font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
			background: radial-gradient(1200px 600px at 50% -10%, #1b2333, #0f1420);
			color: #e9eef5;
			display: grid;
			grid-template-rows: auto 1fr auto;
			gap: 14px;
		}
		header, footer {
			padding: 14px 18px;
			display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;
			background: rgba(255,255,255,.03);
			border-bottom: 1px solid rgba(255,255,255,.06);
			backdrop-filter: blur(6px);
		}
		header h1 { font-size: 18px; margin: 0 12px 0 0; letter-spacing: .3px; }
		.controls { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
		select, button {
			background: rgba(255,255,255,.06);
			color: #e9eef5;
			border: 1px solid rgba(255,255,255,.12);
			border-radius: 10px;
			padding: 8px 12px;
			cursor: pointer;
			box-shadow: var(--shadow);
		}
		button.primary { background: #5c7cff; border-color: #7590ff; color: #fff; }
		button:disabled { opacity: .6; cursor: not-allowed; }
		.stats { display: flex; gap: 16px; opacity: .9; font-size: 14px; }
		main { padding: 10px 14px 20px; display: grid; place-items: start center; }
		.board {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(var(--card-size), 1fr));
			gap: var(--gap);
			width: min(100%, 960px);
		}
		.card {
			width: 100%;
			aspect-ratio: 3 / 4;
			perspective: 800px;
			border-radius: var(--radius);
			outline: none;
		}
		.card-inner {
			position: relative;
			width: 100%; height: 100%;
			transform-style: preserve-3d;
			transition: transform 360ms cubic-bezier(.2,.8,.2,1);
			border-radius: var(--radius);
			box-shadow: var(--shadow);
		}
		.card.flipped .card-inner { transform: rotateY(180deg); }
		.card.matched { pointer-events: none; }
		.face {
			position: absolute; inset: 0;
			border-radius: var(--radius);
			backface-visibility: hidden;
			display: grid; place-items: center;
		}
		.face.back {
			background:
				radial-gradient(20px 20px at 20% 25%, rgba(255,255,255,.06), transparent 60%),
				radial-gradient(18px 18px at 80% 70%, rgba(255,255,255,.05), transparent 60%),
				linear-gradient(160deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
			border: 1px solid rgba(255,255,255,.12);
		}
		.face.front {
			transform: rotateY(180deg);
			border: 1px solid rgba(255,255,255,.16);
			padding: 10px;
			text-align: center;
			background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
		}
		.content {
			display: grid;
			gap: 8px;
			place-items: center;
			margin: 0 6px;
		}
		.term {
			font-size: clamp(16px, 3.2vw, 24px);
			line-height: 1.2;
			font-weight: 700;
		}
		.subtle {
			font-size: 12px;
			opacity: .8;
		}
		.speak {
			font-size: 16px;
			border: 1px solid rgba(255,255,255,.18);
			background: rgba(92,124,255,.16);
			color: #eaf0ff;
			border-radius: 999px;
			padding: 4px 8px;
			cursor: pointer;
		}
		footer { font-size: 12px; color: #cfd7e7; border-top: 1px solid rgba(255,255,255,.06); }
		@media (max-width: 560px) {
			:root { --card-size: 100px; --gap: 10px; }
			header { gap: 10px; }
			.stats { width: 100%; justify-content: space-between; }
		}
	</style>
</head>
<body>
	<header>
		<div style="display:flex;align-items:center;gap:8px;">
			<h1>Thematic Match</h1>
			<span class="subtle">Language â€¢ Math â€¢ History</span>
		</div>
		<div class="controls" role="group" aria-label="Game controls">
			<label for="mode">Mode</label>
			<select id="mode" aria-label="Select mode">
				<option value="language" selected>Language (EN â†” ES)</option>
				<option value="math">Math (Equation â†” Solution)</option>
				<option value="history">Historical Figures (Name â†” Achievement)</option>
			</select>
			<label for="pairs">Pairs</label>
			<select id="pairs" aria-label="Select pair count">
				<option value="6">6</option>
				<option value="8" selected>8</option>
				<option value="10">10</option>
				<option value="12">12</option>
			</select>
			<button id="newGame" class="primary">New Game</button>
		</div>
		<div class="stats" aria-live="polite">
			<div>Moves: <span id="moves">0</span></div>
			<div>Matches: <span id="matches">0</span>/<span id="total">0</span></div>
			<div>Time: <span id="time">0:00</span></div>
		</div>
	</header>

	<main>
		<div id="board" class="board" aria-label="Memory board" role="grid"></div>
	</main>

	<footer>
		Tip: Focus a card and press Space/Enter to flip. In Language mode, use the ðŸ”Š button to hear the word.
	</footer>

	<script>
		(() => {
			const board = document.getElementById('board');
			const movesEl = document.getElementById('moves');
			const matchesEl = document.getElementById('matches');
			const totalEl = document.getElementById('total');
			const timeEl = document.getElementById('time');
			const modeEl = document.getElementById('mode');
			const pairsEl = document.getElementById('pairs');
			const newBtn = document.getElementById('newGame');

			let state = {
				mode: 'language',
				pairs: 8,
				moves: 0,
				matches: 0,
				first: null,
				lock: false,
				started: false,
				startTime: 0,
				timer: null
			};

			// Data sources
			const LANG_PAIRS = [
				['cat','gato','en-US','es-ES'], ['dog','perro','en-US','es-ES'],
				['house','casa','en-US','es-ES'], ['water','agua','en-US','es-ES'],
				['book','libro','en-US','es-ES'], ['sun','sol','en-US','es-ES'],
				['moon','luna','en-US','es-ES'], ['food','comida','en-US','es-ES'],
				['school','escuela','en-US','es-ES'], ['apple','manzana','en-US','es-ES'],
				['car','coche','en-US','es-ES'], ['tree','Ã¡rbol','en-US','es-ES'],
				['milk','leche','en-US','es-ES'], ['red','rojo','en-US','es-ES'],
				['green','verde','en-US','es-ES'], ['blue','azul','en-US','es-ES'],
				['friend','amigo','en-US','es-ES'], ['family','familia','en-US','es-ES'],
				['city','ciudad','en-US','es-ES'], ['work','trabajo','en-US','es-ES']
			];

			const HIST_PAIRS = [
				['Marie Curie','Pioneered research on radioactivity'],
				['Albert Einstein','Developed the theory of relativity'],
				['Ada Lovelace','Wrote the first computer algorithm'],
				['Leonardo da Vinci','Renaissance artist and inventor'],
				['Martin Luther King Jr.','Led the American civil rights movement'],
				['Nelson Mandela','Led anti-apartheid movement; South African president'],
				['Rosa Parks','Sparked the Montgomery Bus Boycott'],
				['Galileo Galilei','Advanced telescope astronomy; supported heliocentrism'],
				['Florence Nightingale','Founder of modern nursing'],
				['Isaac Newton','Formulated laws of motion and gravity'],
				['Mahatma Gandhi','Led Indiaâ€™s nonviolent independence movement'],
				['Wright brothers','Achieved first powered flight'],
				['Katherine Johnson','Calculated NASA orbital trajectories'],
				['Jonas Salk','Developed the first effective polio vaccine'],
				['Charles Darwin','Proposed evolution by natural selection'],
				['Cleopatra','Queen of ancient Egypt'],
				['Joan of Arc','Led French forces in the Hundred Yearsâ€™ War'],
				['Wolfgang A. Mozart','Prolific classical composer'],
				['Frida Kahlo','Mexican painter known for self-portraits'],
				['Srinivasa Ramanujan','Made substantial contributions to mathematics']
			];

			// Utils
			const randInt = (a,b) => Math.floor(Math.random()*(b-a+1))+a;
			function shuffle(arr) {
				for (let i = arr.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[arr[i], arr[j]] = [arr[j], arr[i]];
				}
				return arr;
			}
			function formatTime(ms) {
				const s = Math.floor(ms / 1000);
				const m = Math.floor(s / 60);
				const r = s % 60;
				return `${m}:${r.toString().padStart(2,'0')}`;
			}
			function startTimer() {
				if (state.timer) return;
				state.started = true;
				state.startTime = performance.now();
				state.timer = setInterval(() => {
					timeEl.textContent = formatTime(performance.now() - state.startTime);
				}, 250);
			}
			function stopTimer() {
				if (state.timer) {
					clearInterval(state.timer);
					state.timer = null;
				}
			}

			// Generators
			function genLanguagePairs(n) {
				const pool = shuffle([...LANG_PAIRS]);
				return pool.slice(0, n).map(([en, es, enLang, esLang]) => ({
					id: `lang:${en}:${es}`,
					a: { text: en, note: 'English', lang: enLang },
					b: { text: es, note: 'EspaÃ±ol', lang: esLang }
				}));
			}

			function genMathPairs(n) {
				const results = new Map();
				while (results.size < n) {
					const pick = randInt(0, 9);
					let eq = '', sol = '';
					if (pick < 4) {
						// + or -
						const a = randInt(1, 40), b = randInt(1, 40);
						const op = Math.random() < .5 ? '+' : 'âˆ’';
						eq = `${a} ${op} ${b}`;
						sol = String(op === '+' ? a + b : a - b);
					} else if (pick < 8) {
						// Ã— or Ã· (ensure integer division)
						const op = Math.random() < .5 ? 'Ã—' : 'Ã·';
						if (op === 'Ã—') {
							const a = randInt(2, 12), b = randInt(2, 12);
							eq = `${a} Ã— ${b}`; sol = String(a*b);
						} else {
							const b = randInt(2, 12), c = randInt(2, 12);
							const a = b * c;
							eq = `${a} Ã· ${b}`; sol = String(c);
						}
					} else {
						// simple algebra ax + b = c
						const a = randInt(1, 10);
						const x = randInt(-10, 10);
						const b = randInt(-10, 10);
						const c = a * x + b;
						eq = `${a}x ${b<0?'-':'+'} ${Math.abs(b)} = ${c}`;
						sol = `x = ${x}`;
					}
					const id = `math:${eq}=${sol}`;
					if (!results.has(id)) results.set(id, { id, a: { text: eq, note: 'Equation', lang: 'en-US' }, b: { text: sol, note: 'Solution', lang: 'en-US' } });
				}
				return [...results.values()];
			}

			function genHistoryPairs(n) {
				const pool = shuffle([...HIST_PAIRS]).slice(0, n);
				return pool.map(([name, ach]) => ({
					id: `hist:${name}`,
					a: { text: name, note: 'Name', lang: 'en-US' },
					b: { text: ach, note: 'Achievement', lang: 'en-US' }
				}));
			}

			function buildPairs(mode, n) {
				switch (mode) {
					case 'language': return genLanguagePairs(n);
					case 'math': return genMathPairs(n);
					case 'history': return genHistoryPairs(n);
					default: return genLanguagePairs(n);
				}
			}

			// Rendering
			function createCard(item) {
				const card = document.createElement('div');
				card.className = 'card';
				card.setAttribute('role', 'button');
				card.setAttribute('tabindex', '0');
				card.setAttribute('aria-pressed', 'false');
				card.dataset.pair = item.id;

				const inner = document.createElement('div');
				inner.className = 'card-inner';

				const faceFront = document.createElement('div');
				faceFront.className = 'face front';
				const content = document.createElement('div');
				content.className = 'content';

				const term = document.createElement('div');
				term.className = 'term';
				term.textContent = item.text;

				const note = document.createElement('div');
				note.className = 'subtle';
				note.textContent = item.note || '';

				content.appendChild(term);
				if (item.lang) {
					const speak = document.createElement('button');
					speak.className = 'speak';
					speak.type = 'button';
					speak.textContent = 'ðŸ”Š Speak';
					speak.addEventListener('click', (e) => {
						e.stopPropagation();
						if ('speechSynthesis' in window) {
							const u = new SpeechSynthesisUtterance(item.text);
							u.lang = item.lang;
							u.rate = 0.95;
							window.speechSynthesis.cancel();
							window.speechSynthesis.speak(u);
						}
					});
					content.appendChild(speak);
				}
				content.appendChild(note);
				faceFront.appendChild(content);

				const faceBack = document.createElement('div');
				faceBack.className = 'face back';

				inner.appendChild(faceFront);
				inner.appendChild(faceBack);
				card.appendChild(inner);

				card.addEventListener('click', () => flip(card));
				card.addEventListener('keydown', (e) => {
					if (e.key === 'Enter' || e.key === ' ') {
						e.preventDefault();
						flip(card);
					}
				});
				return card;
			}

			function flip(card) {
				if (state.lock || card.classList.contains('flipped') || card.classList.contains('matched')) return;
				if (!state.started) startTimer();

				card.classList.add('flipped');
				card.setAttribute('aria-pressed', 'true');

				if (!state.first) {
					state.first = card;
					return;
				}

				state.lock = true;
				state.moves++;
				movesEl.textContent = state.moves;

				const second = card;
				const isMatch = state.first.dataset.pair === second.dataset.pair;

				if (isMatch) {
					state.matches++;
					matchesEl.textContent = state.matches;

					[state.first, second].forEach(c => {
						c.classList.add('matched');
						c.setAttribute('aria-pressed', 'true');
					});
					resetTurn();

					if (state.matches === state.pairs) {
						stopTimer();
						celebrate();
					}
				} else {
					setTimeout(() => {
						[state.first, second].forEach(c => {
							c.classList.remove('flipped');
							c.setAttribute('aria-pressed', 'false');
						});
						resetTurn();
					}, 800);
				}
			}

			function resetTurn() {
				state.first = null;
				state.lock = false;
			}

			function buildDeck(mode, pairCount) {
				const pairObjs = buildPairs(mode, pairCount);
				const cards = [];
				pairObjs.forEach(p => {
					cards.push({ id: p.id, text: p.a.text, note: p.a.note, lang: p.a.lang });
					cards.push({ id: p.id, text: p.b.text, note: p.b.note, lang: p.b.lang });
				});
				shuffle(cards);
				board.innerHTML = '';
				cards.forEach(ci => board.appendChild(createCard(ci)));
			}

			function celebrate() {
				board.animate(
					[{ transform: 'scale(1)' }, { transform: 'scale(1.02)' }, { transform: 'scale(1)' }],
					{ duration: 500, easing: 'ease-in-out' }
				);
			}

			function newGame() {
				stopTimer();
				state = {
					mode: modeEl.value,
					pairs: parseInt(pairsEl.value, 10),
					moves: 0, matches: 0,
					first: null, lock: false,
					started: false, startTime: 0, timer: null
				};
				movesEl.textContent = '0';
				matchesEl.textContent = '0';
				totalEl.textContent = String(state.pairs);
				timeEl.textContent = '0:00';
				buildDeck(state.mode, state.pairs);
			}

			newBtn.addEventListener('click', newGame);
			modeEl.addEventListener('change', newGame);
			pairsEl.addEventListener('change', newGame);

			// Initialize
			newGame();
		})();
	</script>
</body>
</html>
